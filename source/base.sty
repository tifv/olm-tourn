\usepackage{jeolm}
\usepackage{jeolm-olymp}

\parindent=0pt

% default figures placement
\def\fps@figure{tbp}

\usepackage{pgfpages}
\pgfpagesuselayout{resize to}[a4paper]

% Miscellaneous templates
\def\problemmark#1{\textsf{(#1)}}

\let\postword\relax

% \begin{macro}{\jeolmheaderhrule}
%    \begin{macrocode}
\newlength{\jeolmhrule@width}%
\newlength{\jeolmhrule@textwidth}%
\newcommand\jeolmhrule[1]{\begingroup\let\sp\quad
\settowidth{\jeolmhrule@textwidth}{\hbox{\strut\sp#1\sp\strut}}%
\jeolmhrule@width=0.5\textwidth%
\addtolength{\jeolmhrule@width}{-0.5\jeolmhrule@textwidth}%
\rule[0.5ex]{\jeolmhrule@width}{0.5pt}%
\sp#1\sp
\rule[0.5ex]{\jeolmhrule@width}{0.5pt}
\endgroup}
%    \end{macrocode}
% \end{macro}

\newcommand\jeolmtournheadertemplate[3]{%
{\Large\vspace{4ex}}\par%
\begingroup\small\sffamily
\strut\hfill{\bfseries#1}\hfill\strut\\[0.3ex]
\strut\hfill{\itshape#3}\qquad{#2}\hfill\strut{\large\bfseries\\[0.3ex]
\jeolmhrule{\jeolmleague}}
\endgroup
\vspace{-\parskip}
\@ifnextchar*{\@gobble}{{\Large\vspace{-4ex}}}}

\newcommand\regattacaptiontemplate[5]{%
\parbox{0.69\textwidth}{
\vspace{1ex}
\textbf{\Large{#4}}
\par\vspace{2ex}
\textbf{#1:}\ \hbox to 10em{\hrulefill}
\vspace{1ex}}
\parbox{0.3\textwidth}{
\setlength{\fboxsep}{2em}
\texttt{#2{:}\ }\fbox{\phantom{S}}
\par\vspace{1ex}
\texttt{#3{:}\ #5}}%
\vspace{1ex}}

%%%%%%%%%%
% Problem/solution segregation

% High-level dispatch
\newenvironment{tourn-problems}[1]%
    {\def\problem@tourn@env{tourn-problems/#1}%
        \begin{\problem@tourn@env}}%
    {\end{\problem@tourn@env}}
\newcommand\tournproblem[1]{\def\problem@tourn@number{\itemy{#1}}}
\newenvironment{tourn-problems/complete}%
    {\begin{problems}\let\problem\problem@tourn@complete}%
    {\end{problems}}
\newenvironment{tourn-problems/problems}
    {\begin{problems}\let\problem\problem@tourn@problem}%
    {\end{problems}}%
\newenvironment{tourn-problems/solutions}%
    {\begin{problems}\let\problem\problem@tourn@solution}%
    {\end{problems}}%

% Selection/formatting 
\long\def\problem@tourn@complete#1\endproblem{\begingroup
\problem@tourn@parse#1\endproblem
{\problem@tourn@fetched@preproblem}{\problem@tourn@fetched@presolution}%
\problem@tourn@number\problem@tourn@fetched@problem
\solution@delimiter\problem@tourn@fetched@solution
\endgroup}
\long\def\problem@tourn@problem#1\endproblem{\begingroup
\problem@tourn@parse#1\endproblem
{\problem@tourn@fetched@preproblem}%
\problem@tourn@number\problem@tourn@fetched@problem
\endgroup}
\long\def\problem@tourn@solution#1\endproblem{\begingroup
\problem@tourn@parse#1\endproblem
{\problem@tourn@fetched@presolution}%
\problem@tourn@number\problem@tourn@fetched@solution
\endgroup}

% Parsing/segregation
\long\def\problem@tourn@parse#1\solution#2\endproblem{%
    \@ifnextchar[%
        {\problem@tourn@parse@preproblem}%
        {\problem@tourn@parse@problem}#1\endproblem%
    \@ifnextchar[%
        {\problem@tourn@parse@presolution}%
        {\problem@tourn@parse@solution}#2\endsolution%
}
\long\def\problem@tourn@parse@preproblem[#1]#2\endproblem{%
    \long\def\problem@tourn@fetched@preproblem{#1}%
    \long\def\problem@tourn@fetched@problem{#2}}
\long\def\problem@tourn@parse@problem#1\endproblem{%
    \long\def\problem@tourn@fetched@preproblem{}%
    \long\def\problem@tourn@fetched@problem{#1}}
\long\def\problem@tourn@parse@presolution[#1]#2\endsolution{%
    \long\def\problem@tourn@fetched@presolution{#1}%
    \long\def\problem@tourn@fetched@solution{#2}}
\long\def\problem@tourn@parse@solution#1\endsolution{%
    \long\def\problem@tourn@fetched@presolution{}%
    \long\def\problem@tourn@fetched@solution{#1}}

\newcommand\solution@delimiter{$\square$\quad}

