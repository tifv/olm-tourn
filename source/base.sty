\usepackage{jeolm}
\usepackage{jeolm-olymp}

\parindent=0pt

% default figures placement
\def\fps@figure{tbp}

\usepackage{pgfpages}
\pgfpagesuselayout{resize to}[a4paper]

% Miscellaneous templates
\def\problemmark#1{\textsf{(#1)}}

\let\postword\relax

% \begin{macro}{\jeolmheaderhrule}
%    \begin{macrocode}
\newlength{\jeolmhrule@width}%
\newlength{\jeolmhrule@textwidth}%
\newcommand\jeolmhrule[1]{\begingroup\let\sp\quad
\settowidth{\jeolmhrule@textwidth}{\hbox{\strut\sp#1\sp\strut}}%
\jeolmhrule@width=0.5\textwidth%
\addtolength{\jeolmhrule@width}{-0.5\jeolmhrule@textwidth}%
\rule[0.5ex]{\jeolmhrule@width}{0.5pt}%
\sp#1\sp
\rule[0.5ex]{\jeolmhrule@width}{0.5pt}
\endgroup}
%    \end{macrocode}
% \end{macro}

\newcommand\jeolmtournheadertemplate[3]{%
{\Large\vspace{4ex}}\par%
\begingroup\small\sffamily
\strut\hfill{\bfseries#1}\hfill\strut\\[0.3ex]
\strut\hfill{\itshape#3}\qquad{#2}\hfill\strut{\large\bfseries\\[0.3ex]
\jeolmhrule{\jeolmleague}}
\endgroup
\vspace{-\parskip}
\@ifnextchar*{\@gobble}{{\Large\vspace{-4ex}}}}

\newcommand\regattacaptiontemplate[5]{%
\parbox{0.69\textwidth}{
\vspace{1ex}
\textbf{\Large{#4}}
\par\vspace{2ex}
\textbf{#1:}\ \hbox to 10em{\hrulefill}
\vspace{1ex}}
\parbox{0.3\textwidth}{
\setlength{\fboxsep}{2em}
\texttt{#2{:}\ }\fbox{\phantom{S}}
\par\vspace{1ex}
\texttt{#3{:}\ #5}}%
\vspace{1ex}}

% Problem/solution segregation

\usepackage{catchfile}

\def\fetchproblemsolution#1{\begingroup
\CatchFileDef{\theinput}{#1}{}%
\expandafter\parseproblemsolution\theinput\endproblem
\endgroup}
\long\def\parseproblemsolution#1\solution#2\endproblem{%
\@ifnextchar[{\parsepreproblem}{\parseproblem}#1\endproblem
\@ifnextchar[{\parsepresolution}{\parsesolution}#2\endsolution}
\long\def\parsepreproblem[#1]#2\endproblem{%
    \global\def\preproblem@fetched{#1}%
    \global\def\problem@fetched{#2}}
\long\def\parseproblem#1\endproblem{%
    \global\def\preproblem@fetched{}%
    \global\def\problem@fetched{#1}}
\long\def\parsepresolution[#1]#2\endsolution{%
    \global\def\presolution@fetched{#1}%
    \global\def\solution@fetched{#2}}
\long\def\parsesolution#1\endsolution{%
    \global\def\presolution@fetched{}%
    \global\def\solution@fetched{#1}}

\newcommand\problemsolutioninput[2]{\fetchproblemsolution{#2}%
{\preproblem@fetched\presolution@fetched}%
#1\problem@fetched\solution@delimiter\solution@fetched}
\newcommand\probleminput[2]{\fetchproblemsolution{#2}%
\preproblem@fetched#1\problem@fetched}
\newcommand\solutioninput[2]{\fetchproblemsolution{#2}%
\presolution@fetched#1\solution@fetched}

\newcommand\solution@delimiter{$\square$\quad}

