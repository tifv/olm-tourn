\problem\problemscore{10}
В~куче лежит $n > 1$ камней.
Двое по~очереди берут из~кучи камни.
Первым ходом можно взять любое количество камней от~1 до~$n-1$.
Каждым следующим ходом можно брать любое количество камней от~1 до~$2 k$, где
$k$~--- количество камней, взятых на~предыдущем ходу противником.
Выигрывает взявший последний камень.
Определите, при каких $n$ второй игрок имеет выигрышную стратегию.
\solution
Обозначим $n$-е число Фибоначчи через $F_n$.
Напомним, что $F_0 = 0$, $F_1 = 1$ и~$F_n = F_{n-1} + F_{n-2}$ для всех
$n \geq 2$.
\emph{Ответ:} второй игрок выиграет при $n = F_k$ для $k \geq 3$.
\par
Обозначим через $(n, m)$ позицию, при которой осталось $n$ шаров, и~игрок может
взять не~более $m$ из~них, $m > 0$
(т.~е. если противник предыдущим ходом забрал $k$ шаров, то~$m = 2 k$).
Разложим $n$ в~фибоначчиеву систему счисления:
$n = F_{i_1} + F_{i_2} + \ldots + F_{i_r}$,
где $i_1 > i_2 > \cdots > i_r \geq 2$ и~индексы $i_j$ не~соседние
(при этом, $F_{i_1}$ определяется однозначно как наибольшее число Фиббоначи,
не~превосходящее $n$, $F_{i_2}$~--- наибольшее, не~превосходящее $n - F_{i_1}$,
и~т.~д.).
Индукцией по~$n$ докажем, что позиция $(n, m)$ проигрышная тогда и~только
тогда, когда $m < F_{i_r}$.
\par
База $n = 1$ очевидна.
Пусть для всех чисел меньше $n$ наше утверждение верно.
Запишем $n = F_{i_1} + F_{i_2} + \ldots + F_{i_r}$.
Если $m \geq F_{i_r}$, то, взяв $F_{i_r}$ шаров, получаем
(так как $i_{r-1} \geq i_r + 2$
и~$F_{i_{r-1}} > 2 F_{i_{r-1}-2} \geq 2 F_{i_r}$)
проигрышную позицию, и, следовательно, изначальная позиция была выигрышной.
\par
Осталось доказать, что мы~не~сможем попасть в~проигрышную позицию при
$m < F_{i_r}$.
Пусть взяв $x$ шаров, мы~попали в~проигрышную позицию $(n-x, 2 x)$
и~\(
    n - x
=
    F_{i_1} + F_{i_2} + \ldots + F_{i_{r-1}} +
    F_{j_1} + F_{j_2} + \ldots + F_{j_s}
\).
Заметим, что $n \geq (n - x) + F_{j_s-1}$, откуда $x \geq F_{j_s-1}$.
Следовательно, $2 x \geq F_{j_s}$, и~исходная позиция выигрышная.
\par
Осталось заметить, что исходная позиция имеет вид $(n, n-1)$, и~является
проигрышной (для первого игрока) только при $n - 1 < F_k = n$;
так как $n - 1 \geq 1$, то~$k \geq 3$.
\endproblem
% $problem-source: Brazil 2014
