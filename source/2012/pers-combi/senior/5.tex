Даны натуральные числа $r$ и $n$, $r \leq n$.
Рассматриваются всевозможные упорядоченные наборы $(k_1, k_2, \ldots, k_n)$
неотрицательных целых чисел, такие, что
$k_1 + k_2 + \ldots + k_n = r$, $k_1 + 2 k_2 + \ldots + n k_n = n$.
Для каждого набора вычислена дробь $\frac{1}{k_1! k_2! \ldots k_n!}$
(напомним, что $0! = 1$).
Докажите, что сумма этих дробей равна
\(
    \frac{(n - 1)!}{(n - r)! r! (r - 1)!}
\).

\solution
Рассмотрим все разбиения числа $n$ в сумму $r$ натуральных слагаемых с учетом
порядка.
Их ровно
$C_{n - 1}^{r - 1} = \frac{(n - 1)!}{(r - 1)! \, (n - r)!}$
(берем палочку длины $n$, разбитую на единичные отрезки $n - 1$ точкой, и из
них выбираем $r - 1$, по которым режем на $r$ частей).
С другой стороны, если в таком разбиении $k_1$ единиц, $k_2$ двоек и так далее,
то $\sum k_i = r$, $\sum i k_i = n$, а количество разбиений в точности
$\frac{r!}{\prod k_i!}$
(выпишем наши $r$ слагаемых считая их как бы различными~--- это можно сделать
$r!$ способами;
а потом вспомним, что от порядка, допустим, единиц на деле ничего не зависит).
\par
\emph{Другое решение.}
Рассмотрим перестановки $\pi \in S_n$ с ровно $r$ циклами, в каждом из которых
помечен один элемент.
Иными словами, у нас будет $r$ ориентированных окружностей, на них выписаны в
совокупности по разу числа от 1 до $n$, и на каждой окружности одно число
отмечено.
Порядок окружностей роли не играет.
Если зафиксировать количество $k_i$ циклов длины $i$
(окружностей с ровно $i$ числами), то таких помеченных перестановок будет
$\frac{n!}{\prod k_i!}$
(берем любую перестановку и выписываем в ряд элементы её циклов, циклы берутся
по возрастанию длины, в каждом цикле элементы выписываются начиная с
отмеченного.
Например, для перестановки $(7) (3) (6) (1 2) (4 5)$ с отмеченными элементами
7, 3, 6, 2, 4 мы получим перестановки 3762145, 6734521 и так далее, всего
$\prod k_i!$ перестановок.
Но любая перестановка чисел от $1$ до $n$ будет выписана ровно один раз, так
что $N \prod k_i! = n!$, где $N$ есть число рассматриваемых помеченных
перестановок.)
Мы хотим доказать, что общее число таких помеченных перестановок равно
$C_n^{r} r (r + 1) \ldots (n - 1)$.
Фиксируем $r$ отмеченных элементов, каждый поставим на свою окружность.
Берем первый еще не поставленный на окружности элемент $x$, его можно поставить
в $r$ мест (одно место на каждой окружности).
Для второго элемента есть уже $r + 1$ место, и так далее.

